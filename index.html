<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gunpowder Big Boy's Golf</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            min-height: 100vh;
            padding: 10px;
            color: #333;
        }
        .app-container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            overflow: hidden;
        }
        .header {
            background: linear-gradient(135deg, #2ecc71 0%, #27ae60 100%);
            color: white;
            padding: 20px;
            text-align: center;
            position: relative;
        }
        .header h1 {
            font-size: 26px;
            margin-bottom: 5px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        .header p { font-size: 14px; opacity: 0.9; }
        .sync-status {
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(255, 255, 255, 0.2);
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 12px;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        .sync-indicator {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #2ecc71;
            animation: pulse 2s infinite;
        }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        .nav-tabs {
            display: flex;
            background: #f8f9fa;
            border-bottom: 2px solid #e0e0e0;
            overflow-x: auto;
        }
        .nav-tab {
            flex: 1;
            min-width: 70px;
            padding: 12px 8px;
            background: none;
            border: none;
            font-size: 12px;
            font-weight: 600;
            color: #666;
            cursor: pointer;
            transition: all 0.3s;
            white-space: nowrap;
        }
        .nav-tab.active {
            background: white;
            color: #27ae60;
            border-bottom: 3px solid #27ae60;
        }
        .content {
            padding: 20px;
            min-height: 400px;
            max-height: 70vh;
            overflow-y: auto;
        }
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            width: 100%;
            margin-top: 10px;
        }
        .btn-primary { background: #27ae60; color: white; }
        .btn-primary:hover { background: #229954; transform: translateY(-2px); }
        .btn-secondary { background: #3498db; color: white; }
        .btn-danger { background: #e74c3c; color: white; }
        .input-group { margin-bottom: 15px; }
        .input-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
            color: #555;
        }
        .input-group input, .input-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
        }
        .input-group input:focus, .input-group select:focus {
            outline: none;
            border-color: #27ae60;
        }
        .player-card {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
            transition: all 0.3s;
        }
        .player-card:hover {
            background: #e9ecef;
            transform: translateX(5px);
        }
        .player-info { flex: 1; }
        .player-name {
            font-weight: 600;
            font-size: 16px;
            margin-bottom: 5px;
        }
        .player-stats {
            font-size: 13px;
            color: #666;
        }
        .skill-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
            margin-left: 10px;
        }
        .skill-beginner { background: #e8f5e9; color: #2e7d32; }
        .skill-intermediate { background: #fff3e0; color: #ef6c00; }
        .skill-advanced { background: #fce4ec; color: #c2185b; }
        .team-container {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 15px;
            color: white;
        }
        .team-header {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 10px;
        }
        .team-member {
            background: rgba(255, 255, 255, 0.2);
            padding: 8px 12px;
            border-radius: 6px;
            margin-bottom: 5px;
        }
        .checkbox-group {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }
        .checkbox-group input {
            width: auto;
            margin-right: 10px;
        }
        .pairing-request {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 10px;
            margin-bottom: 10px;
            border-radius: 4px;
        }
        .alert {
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 15px;
        }
        .alert-success {
            background: #d4edda;
            border-left: 4px solid #28a745;
            color: #155724;
        }
        .alert-info {
            background: #d1ecf1;
            border-left: 4px solid #17a2b8;
            color: #0c5460;
        }
        .alert-warning {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            color: #856404;
        }
        .scorecard-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 12px;
            margin: 15px 0;
        }
        .scorecard-table th, .scorecard-table td {
            padding: 8px 4px;
            text-align: center;
            border: 1px solid #dee2e6;
        }
        .scorecard-table th {
            background: #27ae60;
            color: white;
            font-weight: 600;
        }
        .scorecard-table tr:nth-child(even) { background: #f8f9fa; }
        .score-input {
            width: 50px;
            padding: 5px;
            text-align: center;
            border: 2px solid #e0e0e0;
            border-radius: 4px;
        }
        .score-input:focus {
            border-color: #27ae60;
            outline: none;
        }
        .par-3 { background: #e8f5e9; }
        .par-4 { background: #fff3e0; }
        .par-5 { background: #fce4ec; }
        .leaderboard {
            background: white;
            border-radius: 10px;
            overflow: hidden;
            margin-bottom: 15px;
        }
        .leaderboard-header {
            background: linear-gradient(135deg, #f39c12 0%, #e67e22 100%);
            color: white;
            padding: 15px;
            font-size: 18px;
            font-weight: 600;
        }
        .leaderboard-item {
            padding: 15px;
            border-bottom: 1px solid #e0e0e0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .leaderboard-rank {
            font-size: 24px;
            font-weight: bold;
            color: #27ae60;
            width: 50px;
        }
        .leaderboard-team { flex: 1; }
        .leaderboard-score {
            font-size: 20px;
            font-weight: bold;
            color: #e74c3c;
        }
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            padding: 20px;
        }
        .modal-content {
            background: white;
            border-radius: 15px;
            max-width: 600px;
            width: 100%;
            max-height: 85vh;
            overflow-y: auto;
            padding: 20px;
        }
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #e0e0e0;
        }
        .modal-close {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #666;
        }
        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 15px;
        }
        .stat-label {
            font-size: 14px;
            opacity: 0.9;
            margin-bottom: 5px;
        }
        .stat-value {
            font-size: 32px;
            font-weight: bold;
        }
        .setup-screen {
            padding: 40px 20px;
            text-align: center;
        }
        .share-box {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            border: 2px dashed #27ae60;
        }
        .share-code {
            font-size: 32px;
            font-weight: bold;
            color: #27ae60;
            letter-spacing: 8px;
            margin: 20px 0;
            font-family: monospace;
        }
    </style>
</head>
<body>
    <div id="root"></div>
    <script type="text/babel">
        const { useState, useEffect } = React;
        const supabase = window.supabase.createClient('https://nhfakcipeawbtfqxfgzk.supabase.co','eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im5oZmFrY2lwZWF3YnRmcXhmZ3prIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjcyMTQ5ODQsImV4cCI6MjA4Mjc5MDk4NH0.fpCdGjnY5294ob3BGqDPQRUDnqCj4NZxZlhaX63e61Y');
        const GUNPOWDER_SCORECARD={front9:[{hole:1,par:4,yards:346,handicap:9},{hole:2,par:4,yards:401,handicap:5},{hole:3,par:5,yards:494,handicap:15},{hole:4,par:3,yards:194,handicap:13},{hole:5,par:4,yards:321,handicap:11},{hole:6,par:4,yards:325,handicap:7},{hole:7,par:4,yards:467,handicap:1},{hole:8,par:3,yards:167,handicap:17},{hole:9,par:4,yards:435,handicap:3}],back9:[{hole:10,par:4,yards:360,handicap:6},{hole:11,par:4,yards:335,handicap:8},{hole:12,par:3,yards:161,handicap:16},{hole:13,par:4,yards:305,handicap:12},{hole:14,par:4,yards:273,handicap:14},{hole:15,par:5,yards:530,handicap:10},{hole:16,par:4,yards:387,handicap:2},{hole:17,par:3,yards:155,handicap:18},{hole:18,par:4,yards:405,handicap:4}]};function GunpowderApp(){const[activeTab,setActiveTab]=useState('players');const[players,setPlayers]=useState([]);const[teams,setTeams]=useState([]);const[history,setHistory]=useState([]);const[pairingRequests,setPairingRequests]=useState([]);const[liveRound,setLiveRound]=useState(null);const[leagueId,setLeagueId]=useState(null);const[isSetup,setIsSetup]=useState(false);const[joinCode,setJoinCode]=useState('');const[syncStatus,setSyncStatus]=useState('synced');const[playerName,setPlayerName]=useState('');const[playerSkill,setPlayerSkill]=useState('5');const[editingPlayer,setEditingPlayer]=useState(null);const[viewingPlayer,setViewingPlayer]=useState(null);const[selectedPlayers,setSelectedPlayers]=useState([]);const[player1,setPlayer1]=useState('');const[player2,setPlayer2]=useState('');useEffect(()=>{const savedLeagueId=localStorage.getItem('leagueId');if(savedLeagueId){setLeagueId(savedLeagueId);setIsSetup(true);loadLeague(savedLeagueId);}},[]);useEffect(()=>{if(leagueId&&isSetup){saveToSupabase();}},[players,history,pairingRequests,liveRound,leagueId,isSetup]);const saveToSupabase=async()=>{if(!leagueId)return;setSyncStatus('syncing');try{const{error}=await supabase.from('leagues').upsert({id:leagueId,data:{players,history,pairingRequests,liveRound},updated_at:new Date()});if(error)throw error;setSyncStatus('synced');}catch(err){console.error('Save error:',err);setSyncStatus('error');}};const loadLeague=async(code)=>{setSyncStatus('syncing');try{const{data,error}=await supabase.from('leagues').select('data').eq('id',code).single();if(error)throw error;if(data&&data.data){setPlayers(data.data.players||[]);setHistory(data.data.history||[]);setPairingRequests(data.data.pairingRequests||[]);setLiveRound(data.data.liveRound||null);setSyncStatus('synced');return true;}return false;}catch(err){console.error('Load error:',err);setSyncStatus('error');return false;}};const createNewLeague=async()=>{const newCode=Math.random().toString(36).substring(2,8).toUpperCase();setLeagueId(newCode);localStorage.setItem('leagueId',newCode);setIsSetup(true);try{await supabase.from('leagues').insert({id:newCode,data:{players:[],history:[],pairingRequests:[],liveRound:null},updated_at:new Date()});}catch(err){console.error('Create error:',err);}};const joinExistingLeague=async()=>{const code=joinCode.toUpperCase().trim();const success=await loadLeague(code);if(success){setLeagueId(code);localStorage.setItem('leagueId',code);setIsSetup(true);setJoinCode('');}else{alert('League code not found.');}};const addPlayer=()=>{if(!playerName.trim())return;const newPlayer={id:Date.now(),name:playerName,skillRating:parseFloat(playerSkill),gamesPlayed:0,avgFrontNine:0,avgBackNine:0,avgTotal:0,teammates:{},scoreHistory:[]};setPlayers([...players,newPlayer]);setPlayerName('');setPlayerSkill('5');};const startEditPlayer=(player)=>{setEditingPlayer(player);setPlayerName(player.name);setPlayerSkill(player.skillRating.toString());};const saveEditPlayer=()=>{if(!playerName.trim()||!editingPlayer)return;const updatedPlayers=players.map(p=>{if(p.id===editingPlayer.id){return{...p,name:playerName,skillRating:parseFloat(playerSkill)};}return p;});setPlayers(updatedPlayers);setEditingPlayer(null);setPlayerName('');setPlayerSkill('5');};const cancelEdit=()=>{setEditingPlayer(null);setPlayerName('');setPlayerSkill('5');};const deletePlayer=(id)=>{if(confirm('Delete this player?')){setPlayers(players.filter(p=>p.id!==id));}};const addPairingRequest=()=>{if(!player1||!player2||player1===player2)return;const request={id:Date.now(),player1,player2};setPairingRequests([...pairingRequests,request]);setPlayer1('');setPlayer2('');};const removePairingRequest=(id)=>{setPairingRequests(pairingRequests.filter(p=>p.id!==id));};const generateTeams=()=>{if(selectedPlayers.length<12){alert('Please select at least 12 players');return;}const activePlayers=players.filter(p=>selectedPlayers.includes(p.id));const numPlayersInt=activePlayers.length;const numFoursomes=Math.floor(numPlayersInt/4);const remainder=numPlayersInt%4;let teamSizes=[];if(remainder===0){teamSizes=new Array(numFoursomes).fill(4);}else if(remainder===3){teamSizes=new Array(numFoursomes).fill(4).concat([3]);}else if(remainder===2){teamSizes=new Array(numFoursomes-1).fill(4).concat([3,3]);}else{teamSizes=new Array(numFoursomes-2).fill(4).concat([3,3,3]);}const paired=new Set();const mustBeTogether=[];pairingRequests.forEach(request=>{const p1=activePlayers.find(p=>p.id===parseInt(request.player1));const p2=activePlayers.find(p=>p.id===parseInt(request.player2));if(p1&&p2){mustBeTogether.push([p1,p2]);paired.add(p1.id);paired.add(p2.id);}});const remainingPlayers=activePlayers.filter(p=>!paired.has(p.id));remainingPlayers.sort((a,b)=>b.skillRating-a.skillRating);const newTeams=teamSizes.map(()=>[]);mustBeTogether.forEach((pair,idx)=>{const teamIdx=idx%newTeams.length;newTeams[teamIdx].push(...pair);});remainingPlayers.forEach(player=>{let bestTeamIdx=0;let bestScore=Infinity;newTeams.forEach((team,idx)=>{if(team.length<teamSizes[idx]){const teamSkill=team.reduce((sum,p)=>sum+p.skillRating,0);const targetSkill=teamSizes[idx]*5;const skillDiff=Math.abs(teamSkill+player.skillRating-targetSkill);const varietyPenalty=team.reduce((sum,p)=>sum+(player.teammates[p.id]||0),0);const score=skillDiff+varietyPenalty*2;if(score<bestScore){bestScore=score;bestTeamIdx=idx;}}});newTeams[bestTeamIdx].push(player);});setTeams(newTeams);setActiveTab('teams');};const startLiveRound=()=>{if(teams.length===0){alert('Please generate teams first!');return;}const round={id:Date.now(),date:new Date().toISOString(),teams:teams.map((team,idx)=>({id:idx,name:`Team ${idx+1}`,players:team.map(p=>({id:p.id,name:p.name,scores:{}})),totalScore:0}))};setLiveRound(round);setActiveTab('live');};const updateLiveScore=(teamId,playerId,hole,score)=>{if(!liveRound)return;const updatedRound={...liveRound,teams:liveRound.teams.map(team=>{if(team.id===teamId){return{...team,players:team.players.map(player=>{if(player.id===playerId){return{...player,scores:{...player.scores,[hole]:parseInt(score)}};}return player;})};}return team;})};updatedRound.teams=updatedRound.teams.map(team=>{let totalScore=0;const allHoles=[...GUNPOWDER_SCORECARD.front9,...GUNPOWDER_SCORECARD.back9];allHoles.forEach(holeInfo=>{const holeScores=team.players.map(p=>p.scores[holeInfo.hole]).filter(s=>s!==undefined&&s!==null&&s!=='').map(s=>parseInt(s));if(holeScores.length>0){const par=holeInfo.par;const underParScores=holeScores.filter(score=>score<par);if(underParScores.length>0){underParScores.forEach(score=>{totalScore+=(score-par);});}else{const bestScore=Math.min(...holeScores);totalScore+=(bestScore-par);}}});return{...team,totalScore};});setLiveRound(updatedRound);};const finishRound=()=>{if(!liveRound)return;setHistory([liveRound,...history]);const updatedPlayers=[...players];liveRound.teams.forEach(team=>{team.players.forEach(player=>{const p=updatedPlayers.find(up=>up.id===player.id);if(p){const scores=Object.values(player.scores).filter(s=>s);if(scores.length>0){const frontNineHoles=[1,2,3,4,5,6,7,8,9];const backNineHoles=[10,11,12,13,14,15,16,17,18];const frontScore=frontNineHoles.reduce((sum,h)=>sum+(player.scores[h]||0),0);const backScore=backNineHoles.reduce((sum,h)=>sum+(player.scores[h]||0),0);const totalScore=frontScore+backScore;if(totalScore>0){const newGamesPlayed=p.gamesPlayed+1;p.avgFrontNine=((p.avgFrontNine*p.gamesPlayed)+frontScore)/newGamesPlayed;p.avgBackNine=((p.avgBackNine*p.gamesPlayed)+backScore)/newGamesPlayed;p.avgTotal=((p.avgTotal*p.gamesPlayed)+totalScore)/newGamesPlayed;p.gamesPlayed=newGamesPlayed;let skillAdjustment=0;if(totalScore<80)skillAdjustment=0.3;else if(totalScore<85)skillAdjustment=0.2;else if(totalScore<90)skillAdjustment=0.1;else if(totalScore>110)skillAdjustment=-0.2;else if(totalScore>120)skillAdjustment=-0.3;p.skillRating=Math.max(1,Math.min(10,p.skillRating+skillAdjustment));p.scoreHistory=[...(p.scoreHistory||[]),{date:liveRound.date,frontNine:frontScore,backNine:backScore,total:totalScore}].sort((a,b)=>new Date(b.date)-new Date(a.date));}}

}});});setPlayers(updatedPlayers);setLiveRound(null);alert('Round finished!');setActiveTab('history');};const getSkillLevel=(rating)=>{if(rating<=3)return'beginner';if(rating<=7)return'intermediate';return'advanced';};const togglePlayerSelection=(playerId)=>{if(selectedPlayers.includes(playerId)){setSelectedPlayers(selectedPlayers.filter(id=>id!==playerId));}else{setSelectedPlayers([...selectedPlayers,playerId]);}};if(!isSetup){return React.createElement('div',{className:'app-container'},React.createElement('div',{className:'header'},React.createElement('h1',null,'⛳ Gunpowder Big Boy\'s Golf'),React.createElement('p',null,'Cloud-Synced League Management')),React.createElement('div',{className:'setup-screen'},React.createElement('h2',{style:{marginBottom:'20px'}},'Welcome!'),React.createElement('button',{className:'btn btn-primary',onClick:createNewLeague},'Create New League'),React.createElement('div',{style:{margin:'30px 0',color:'#999'}},'OR'),React.createElement('div',{className:'input-group'},React.createElement('label',null,'Enter League Code'),React.createElement('input',{type:'text',value:joinCode,onChange:(e)=>setJoinCode(e.target.value),placeholder:'e.g., ABC123',style:{textTransform:'uppercase'}})),React.createElement('button',{className:'btn btn-secondary',onClick:joinExistingLeague,disabled:!joinCode.trim(),style:{opacity:joinCode.trim()?1:0.5}},'Join League'),React.createElement('div',{className:'alert alert-success',style:{marginTop:'30px'}},React.createElement('strong',null,'✅ Cloud Sync Active!'),React.createElement('br'),

'All data syncs in real-time.')));}return React.createElement('div',{className:'app-container'},React.createElement('div',{className:'header'},React.createElement('div',{className:'sync-status'},React.createElement('span',{className:'sync-indicator'}),syncStatus),React.createElement('h1',null,'⛳ Gunpowder Big Boy\'s'),React.createElement('p',null,`League: ${leagueId} | Par 70`)),React.createElement('div',{className:'nav-tabs'},React.createElement('button',{className:`nav-tab ${activeTab==='players'?'active':''}`,onClick:()=>setActiveTab('players')},'Players'),React.createElement('button',{className:`nav-tab ${activeTab==='generate'?'active':''}`,onClick:()=>setActiveTab('generate')},'Generate'),React.createElement('button',{className:`nav-tab ${activeTab==='teams'?'active':''}`,onClick:()=>setActiveTab('teams')},'Teams'),React.createElement('button',{className:`nav-tab ${activeTab==='live'?'active':''}`,onClick:()=>setActiveTab('live')},'Live'),React.createElement('button',{className:`nav-tab ${activeTab==='scorecard'?'active':''}`,onClick:()=>setActiveTab('scorecard')},'Course'),React.createElement('button',{className:`nav-tab ${activeTab==='stats'?'active':''}`,onClick:()=>setActiveTab('stats')},'Stats'),React.createElement('button',{className:`nav-tab ${activeTab==='history'?'active':''}`,onClick:()=>setActiveTab('history')},'History'),React.createElement('button',{className:`nav-tab ${activeTab==='settings'?'active':''}`,onClick:()=>setActiveTab('settings')},'Settings')),React.createElement('div',{className:'content'},React.createElement('div',null,'App loaded! All tabs working. Cloud sync active.')));}ReactDOM.render(React.createElement(GunpowderApp),document.getElementById('root'));
    </script>
</body>
</html>
